#INCLUDE "RWMAKE.CH"
/*/


Ŀ
Programa   CalcVal   Autor  Osmil Squarcine        Data  05/03/10 
Ĵ
Descrio  Funcao para tratamento do Valor com Acrescimo e Decrescimos
Ĵ
Uso        Especifico para Clientes Microsiga                         
ٱ


/*/

User Function CalcVal()

//
//     Declarao de Variaveis Locais       
//
	Local aArea	:= SE1->(GetArea())	
	Local nVlrAbat	:= 0
	Local nAcresc	:= 0
   	Local nDecres	:= 0
	Local nValorT	:= 0

//
//     Atribuio de Valores                
//
	nValor	:= SE1->E1_VALOR 	
	nVlrAbat:= SomaAbat(SE1->E1_PREFIXO,SE1->E1_NUM,SE1->E1_PARCELA,"R",1,,SE1->E1_CLIENTE,SE1->E1_LOJA)
	nAcresc	:= SE1->E1_ACRESC
   	nDecres := SE1->E1_DECRESC

//
//     Processamento                        
//
	nValorT := nValor - nVlrAbat + nAcresc - nDecres

//
//     Restaura Area                        
//
	RestArea(aArea)

//
//     Retorno da Funo                    
//
Return (nValorT)
